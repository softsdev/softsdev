function PWAPP_EDIT_COVER(){var JSObject=this;this.type="pwapp_editcover",this.form,this.DOMDoc,this.send_btn,this.deletingCover=!1,this.init=function(){PWAPPJSInterface=window.parent.PWAPPJSInterface,this.send_btn=jQuery("#"+this.type+"_send_btn",this.DOMDoc).get(0),this.form=this.DOMDoc.getElementById(this.type+"_form"),this.addButtonsActions(),null!=this.form&&this.initValidation()},this.initValidation=function(){this.validator=jQuery("#"+this.form.id,this.DOMDoc).validate({rules:{pwapp_editcover_cover:{accept:"png|jpg|jpeg|gif"}},messages:{pwapp_editcover_cover:{accept:"Please add a png, gif or jpeg image."}},errorPlacement:function(a,b){var c=b[0].id.split("_"),d=c.length>1?c[c.length-1]:c[0],e=jQuery("#error_"+d+"_container",JSObject.DOMDoc);a.appendTo(e)},errorElement:"span"});var $Cover=jQuery("#"+this.type+"_cover",this.DOMDoc),$RemoveCoverLink=jQuery("#"+this.type+"_cover_removenew",this.DOMDoc);$Cover.bind("change",function(){$Cover.focus(),$Cover.blur(),this.files[0]&&jQuery("#fakefilecover").val(this.files[0].name),$RemoveCoverLink.css("display","block")}),$RemoveCoverLink.bind("click",function(){jQuery("#fakefilecover").val(""),$Cover.val(""),jQuery(JSObject.form).validate().element("#"+JSObject.type+"_cover"),$RemoveCoverLink.css("display","none")});var $EditCoverLink=jQuery("."+this.type+"_changecover",this.DOMDoc);$EditCoverLink.length>0&&$EditCoverLink.click(function(){"none"==jQuery("."+JSObject.type+"_uploadcover",JSObject.DOMDoc).css("display")&&($Cover.val(""),jQuery(JSObject.form).validate().element("#"+JSObject.type+"_cover"),jQuery("#fakefilecover").val(""),$RemoveCoverLink.css("display","none"),jQuery("."+JSObject.type+"_uploadcover",JSObject.DOMDoc).show(),"none"!=jQuery("#"+JSObject.type+"_currentcover",JSObject.DOMDoc).css("background-image")&&jQuery("."+JSObject.type+"_changecover_cancel",JSObject.DOMDoc).show(),"block"==jQuery("."+JSObject.type+"_covercontainer",JSObject.DOMDoc).css("display")&&jQuery("."+JSObject.type+"_covercontainer",JSObject.DOMDoc).hide())});var $CancelEditCoverLink=jQuery("."+this.type+"_changecover_cancel a",this.DOMDoc);$CancelEditCoverLink.length>0&&$CancelEditCoverLink.click(function(){"block"==jQuery("."+JSObject.type+"_uploadcover",JSObject.DOMDoc).css("display")&&($Cover.val(""),jQuery(JSObject.form).validate().element("#"+JSObject.type+"_cover"),jQuery("#fakefilecover").val(""),jQuery("."+JSObject.type+"_uploadcover",JSObject.DOMDoc).hide(),jQuery(this).parent().hide(),"none"==jQuery("."+JSObject.type+"_covercontainer",JSObject.DOMDoc).css("display")&&"none"!=jQuery("#"+JSObject.type+"_currentcover",JSObject.DOMDoc).css("background-image")&&jQuery("."+JSObject.type+"_covercontainer",JSObject.DOMDoc).show())});var $DeleteCoverLink=jQuery("."+this.type+"_deletecover",this.DOMDoc);if($DeleteCoverLink.length>0){var href=$DeleteCoverLink.get(0).href;$DeleteCoverLink.get(0).href="javascript:void(0);",$DeleteCoverLink.click(function(){var isConfirmed=confirm("Are you sure you want to remove the app cover?");isConfirmed&&jQuery.get(ajaxurl,{action:"pwapp_editimages",type:"delete",source:"cover"},function(responseJSON){var JSON=eval("("+responseJSON+")"),response=Boolean(Number(String(JSON.status)));if(JSObject.deletingCover=!1,1==response){jQuery("#"+JSObject.type+"_currentcover",JSObject.DOMDoc).css("background-image","none"),$EditCoverLink.trigger("click");var message="The app cover has been removed.";PWAPPJSInterface.Loader.display({message:message})}else{var message="There was an error. Please try again in few seconds.";PWAPPJSInterface.Loader.display({message:message})}})})}},this.displayImage=function(a,b){jQuery("#"+JSObject.type+"_cover",JSObject.DOMDoc).val(""),jQuery("#fakefilecover").val(""),jQuery("."+JSObject.type+"_uploadcover",JSObject.DOMDoc).hide(),jQuery("."+JSObject.type+"_changecover_cancel",JSObject.DOMDoc).hide(),jQuery("#"+JSObject.type+"_currentcover",JSObject.DOMDoc).css("background-image","url("+b+")"),jQuery("."+JSObject.type+"_covercontainer",JSObject.DOMDoc).css("display","block")},this.addButtonsActions=function(){jQuery(this.send_btn).unbind("click"),jQuery(this.send_btn).bind("click",function(){JSObject.disableButton(this),JSObject.validate()}),JSObject.enableButton(this.send_btn)},this.enableButton=function(a){jQuery(a).css("cursor","pointer"),jQuery(a).animate({opacity:1},100)},this.disableButton=function(a){jQuery(a).unbind("click"),jQuery(a).animate({opacity:.4},100),jQuery(a).css("cursor","default")},this.scrollToError=function(a){var b=jQuery("html,body",JSObject.DOMDoc),c=parseInt(jQuery("html,body").scrollTop())||parseInt(jQuery("body").scrollTop()),d=b.get(0).clientHeight;parseInt(b.offset().top);a<c?jQuery(b).animate({scrollTop:a-20},1e3):a>c+d&&jQuery(b).animate({scrollTop:c+d},1e3)},this.validate=function(){jQuery(this.form).validate().form();var a=[];for(var b in this.validator.invalid){var c=jQuery(this.form[b]);a.push(c.offset().top)}0==a.length?this.sendData():(a.sort(function(a,b){return a-b}),JSObject.scrollToError(a[0]),JSObject.addButtonsActions())},this.submitForm=function(){return PWAPPJSInterface.AjaxUpload.dosubmit(JSObject.form,{onStart:JSObject.startUploadingData,onComplete:JSObject.completeUploadingData})},this.sendData=function(){jQuery("#"+this.form.id,this.DOMDoc).unbind("submit"),jQuery("#"+this.form.id,this.DOMDoc).bind("submit",function(){JSObject.submitForm()}),jQuery("#"+this.form.id,this.DOMDoc).submit(),JSObject.disableButton(JSObject.send_btn)},this.startUploadingData=function(){return PWAPPJSInterface.Preloader.start(),setTimeout(function(){var a=JSObject.form.elements;for(nElems=a.length,j=0;j<nElems;j++)a[j].disabled=!0},300),!0},this.completeUploadingData=function(responseJSON){jQuery("#"+JSObject.form.id,JSObject.DOMDoc).unbind("submit"),jQuery("#"+JSObject.form.id,JSObject.DOMDoc).bind("submit",function(){return!1}),PWAPPJSInterface.Preloader.remove(100);var JSON=eval("("+responseJSON+")"),response=Boolean(Number(String(JSON.status)));if(void 0!=JSON.uploaded_cover&&JSObject.displayImage("cover",JSON.uploaded_cover),1==response&&0==JSON.messages.length){var message="Your app has been successfully modified!";PWAPPJSInterface.Loader.display({message:message})}else if(0==JSON.messages.length){var message="There was an error. Please reload the page and try again.";PWAPPJSInterface.Loader.display({message:message})}else for(var i=0;i<JSON.messages.length;i++)PWAPPJSInterface.Loader.display({message:JSON.messages[i]});setTimeout(function(){var a=JSObject.form.elements;for(nElems=a.length,j=0;j<nElems;j++)a[j].disabled=!1},300),JSObject.addButtonsActions()}}
